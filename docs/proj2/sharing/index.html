

<!DOCTYPE html>

<html lang="en-US">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge">

  <link rel="stylesheet" href="../../assets/css/just-the-docs-default.css">

  <link rel="stylesheet" href="../../assets/css/just-the-docs-head-nav.css" id="jtd-head-nav-stylesheet">

  <style id="jtd-nav-activation">
  

    .site-nav > ul.nav-list:first-child > li > a,
    
    .site-nav > ul.nav-list:first-child > li > ul > li:not(:nth-child(8)) > a,
    .site-nav > ul.nav-list:first-child > li > ul > li > ul > li a {
      background-image: none;
    }

    .site-nav > ul.nav-list:not(:first-child) a,
    .site-nav li.external a {
      background-image: none;
    }

    .site-nav > ul.nav-list:first-child > li:nth-child(7) > ul > li:nth-child(8) > a {
      font-weight: 600;
      text-decoration: none;
    }.site-nav > ul.nav-list:first-child > li:nth-child(7) > button svg,
    .site-nav > ul.nav-list:first-child > li:nth-child(7) > ul > li:nth-child(8) > button svg {
      transform: rotate(-90deg);
    }.site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(7) > ul.nav-list,
    .site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(7) > ul.nav-list > li.nav-list-item:nth-child(8) > ul.nav-list {
      display: block;
    }
  </style>

  

  
    <script src="../../assets/js/vendor/lunr.min.js"></script>
  

  <script src="../../assets/js/just-the-docs.js"></script>

  <meta name="viewport" content="width=device-width, initial-scale=1">

  

  <link rel="icon" href="../../favicon.ico" type="image/x-icon">



  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Sharing and Revocation | CS 161 Fall 2025</title>
<meta name="generator" content="Jekyll v4.4.1" />
<meta property="og:title" content="Sharing and Revocation" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Computer Security at UC Berkeley" />
<meta property="og:description" content="Computer Security at UC Berkeley" />
<link rel="canonical" href="index.html" />
<meta property="og:url" content="https://fa25.cs161.org/proj2/sharing/" />
<meta property="og:site_name" content="CS 161 Fall 2025" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Sharing and Revocation" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"Computer Security at UC Berkeley","headline":"Sharing and Revocation","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://fa25.cs161.org/"}},"url":"https://fa25.cs161.org/proj2/sharing/"}</script>
<!-- End Jekyll SEO tag -->


  <link
  rel="preload"
  href="https://fa25.cs161.org/assets/css/just-the-docs-dark.css"
  as="style"
>

<!-- Intentionally duplicates the default theme stylesheet so there's a fallback when changing themes -->
<link
  id="jtdThemeCSS"
  rel="stylesheet"
  href="../../assets/css/just-the-docs-default.css"
>

<script>
  /* Script to enable persistent dark mode. */

  jtd.getTheme = function () {
    var cssFileHref = (
      document.getElementById('jtdThemeCSS') || document.querySelector('[rel="stylesheet"]')
    ).getAttribute('href');
    return cssFileHref.substring(cssFileHref.lastIndexOf('-') + 1, cssFileHref.length - 4);
  };

  jtd.setTheme = function (theme) {
    var cssFile = document.getElementById('jtdThemeCSS') || document.querySelector('[rel="stylesheet"]');
    cssFile.setAttribute('href', cssFile.getAttribute('href').replace(jtd.getTheme(), theme));
  };

  let toggleDark = () => {
    let setDark = jtd.getTheme() !== 'dark';
    document.documentElement.setAttribute('data-theme', setDark ? 'dark' : 'default');
    document.documentElement.setAttribute('data-theme', setDark ? 'dark' : 'default');
    jtd.setTheme(setDark ? 'dark' : 'default');
    localStorage.setItem('darkMode', String(setDark));

    if (typeof calendar !== 'undefined') {
      calendar.setColorScheme(setDark ? 'dark' : 'light');
    }
  };

  if (localStorage.getItem('darkMode') === 'true') {
    toggleDark();
  }
</script>

<!-- Script for LaTeX rendering. -->
<link
  rel="stylesheet"
  href="../../assets/katex/katex.min.css"
>
<script defer src="../../assets/katex/katex.min.js"></script>
<script>
  function renderKaTeX() {
    renderMathInElement(document.body, {
      delimiters: [
        { left: '$$', right: '$$', display: true },
        { left: '$', right: '$', display: false },
        { left: '\\(', right: '\\)', display: false },
        { left: '\\[', right: '\\]', display: true },
      ],
    });
  }
</script>
<script
  defer
  src="../../assets/katex/contrib/auto-render.min.js"
  onload="renderKaTeX();"
></script>


</head>

<body>
  <a class="skip-to-main" href="index.html#main-content">Skip to main content</a>
  <svg xmlns="http://www.w3.org/2000/svg" class="d-none">
  <symbol id="svg-link" viewBox="0 0 24 24">
  <title>Link</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link">
    <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
  </svg>
</symbol>

  <symbol id="svg-menu" viewBox="0 0 24 24">
  <title>Menu</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu">
    <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line>
  </svg>
</symbol>

  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
  <title>Expand</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right">
    <polyline points="9 18 15 12 9 6"></polyline>
  </svg>
</symbol>

  <!-- Feather. MIT License: https://github.com/feathericons/feather/blob/master/LICENSE -->
<symbol id="svg-external-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link">
  <title id="svg-external-link-title">(external link)</title>
  <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line>
</symbol>

  
    <symbol id="svg-doc" viewBox="0 0 24 24">
  <title>Document</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file">
    <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline>
  </svg>
</symbol>

    <symbol id="svg-search" viewBox="0 0 24 24">
  <title>Search</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search">
    <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line>
  </svg>
</symbol>

  
  
    <!-- Bootstrap Icons. MIT License: https://github.com/twbs/icons/blob/main/LICENSE.md -->
<symbol id="svg-copy" viewBox="0 0 16 16">
  <title>Copy</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16">
    <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/>
    <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/>
  </svg>
</symbol>
<symbol id="svg-copied" viewBox="0 0 16 16">
  <title>Copied</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check-fill" viewBox="0 0 16 16">
    <path d="M6.5 0A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3Zm3 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3Z"/>
    <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1A2.5 2.5 0 0 1 9.5 5h-3A2.5 2.5 0 0 1 4 2.5v-1Zm6.854 7.354-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708.708Z"/>
  </svg>
</symbol>

  
</svg>

  
    <div class="side-bar">
  <div class="site-header" role="banner">
    <a href="https://fa25.cs161.org/" class="site-title lh-tight">


  CS 161 Fall 2025

</a>
    <button id="menu-button" class="site-button btn-reset" aria-label="Toggle menu" aria-pressed="false">
      <svg viewBox="0 0 24 24" class="icon" aria-hidden="true"><use xlink:href="#svg-menu"></use></svg>
    </button>
  </div>

  <nav aria-label="Main" id="site-nav" class="site-nav">
  
  
    <ul class="nav-list"><li class="nav-list-item"><a href="https://fa25.cs161.org/exam/" class="nav-list-link">Exam Logistics</a></li><li class="nav-list-item"><a href="https://fa25.cs161.org/calendar/" class="nav-list-link">Calendar</a></li><li class="nav-list-item"><a href="https://fa25.cs161.org/policies/" class="nav-list-link">Policies</a></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Resources category" aria-pressed="false">
        <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg>
      </button><a href="https://fa25.cs161.org/resources/" class="nav-list-link">Resources</a><ul class="nav-list"><li class="nav-list-item"><a href="https://fa25.cs161.org/resources/faqs/" class="nav-list-link">Spring 2026 FAQs</a></li><li class="nav-list-item"><a href="https://fa25.cs161.org/resources/instructional-machine/" class="nav-list-link">Instructional Machine Setup</a></li></ul></li><li class="nav-list-item"><a href="https://fa25.cs161.org/staff/" class="nav-list-link">Staff</a></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Project 1 category" aria-pressed="false">
        <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg>
      </button><a href="https://fa25.cs161.org/proj1/" class="nav-list-link">Project 1</a><ul class="nav-list"><li class="nav-list-item"><a href="https://fa25.cs161.org/proj1/getting-started/" class="nav-list-link">Getting Started</a></li><li class="nav-list-item"><a href="https://fa25.cs161.org/proj1/customizing/" class="nav-list-link">Customizing</a></li><li class="nav-list-item"><a href="https://fa25.cs161.org/proj1/q1/" class="nav-list-link">Question 1: Remus</a></li><li class="nav-list-item"><a href="https://fa25.cs161.org/proj1/q2/" class="nav-list-link">Question 2: Spica</a></li><li class="nav-list-item"><a href="https://fa25.cs161.org/proj1/q3/" class="nav-list-link">Question 3: Polaris</a></li><li class="nav-list-item"><a href="https://fa25.cs161.org/proj1/q4/" class="nav-list-link">Question 4: Vega</a></li><li class="nav-list-item"><a href="https://fa25.cs161.org/proj1/q5/" class="nav-list-link">Question 5: Deneb</a></li><li class="nav-list-item"><a href="https://fa25.cs161.org/proj1/q6/" class="nav-list-link">Question 6: Antares</a></li><li class="nav-list-item"><a href="https://fa25.cs161.org/proj1/q7/" class="nav-list-link">Question 7: Rigel</a></li><li class="nav-list-item"><a href="https://fa25.cs161.org/proj1/deliverables/" class="nav-list-link">Deliverables</a></li><li class="nav-list-item"><a href="https://fa25.cs161.org/proj1/vm-debugging/" class="nav-list-link">Troubleshooting</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Project 2 category" aria-pressed="false">
        <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg>
      </button><a href="../index.html" class="nav-list-link">Project 2</a><ul class="nav-list"><li class="nav-list-item"><a href="../story/index.html" class="nav-list-link">Story</a></li><li class="nav-list-item"><a href="../policies.html" class="nav-list-link">Project 2 Policies and Deliverables</a></li><li class="nav-list-item"><a href="../getting-started.html" class="nav-list-link">Getting Started</a></li><li class="nav-list-item"><a href="../overview/index.html" class="nav-list-link">Design Overview</a></li><li class="nav-list-item"><a href="../library.html" class="nav-list-link">Library Functions</a></li><li class="nav-list-item"><a href="../userauth/index.html" class="nav-list-link">Users And User Authentication</a></li><li class="nav-list-item"><a href="../files/index.html" class="nav-list-link">File Operations</a></li><li class="nav-list-item"><a href="index.html" class="nav-list-link">Sharing and Revocation</a></li><li class="nav-list-item"><a href="../troubleshooting.html" class="nav-list-link">Debugging and Errors</a></li><li class="nav-list-item"><a href="../advice/index.html" class="nav-list-link">Advice and Tips</a></li><li class="nav-list-item"><a href="../appendix/index.html" class="nav-list-link">Appendix</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Project 3 category" aria-pressed="false">
        <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg>
      </button><a href="https://fa25.cs161.org/proj3/" class="nav-list-link">Project 3</a><ul class="nav-list"><li class="nav-list-item"><a href="https://fa25.cs161.org/proj3/story/" class="nav-list-link">Story</a></li><li class="nav-list-item"><a href="https://fa25.cs161.org/proj3/getting-started/" class="nav-list-link">Getting Started</a></li><li class="nav-list-item"><a href="https://fa25.cs161.org/proj3/tips/" class="nav-list-link">General Tips</a></li><li class="nav-list-item"><a href="https://fa25.cs161.org/proj3/flag1/" class="nav-list-link">Flag 1: dev</a></li><li class="nav-list-item"><a href="https://fa25.cs161.org/proj3/flag2/" class="nav-list-link">Flag 2: ip.txt</a></li><li class="nav-list-item"><a href="https://fa25.cs161.org/proj3/flag3/" class="nav-list-link">Flag 3: shomil</a></li><li class="nav-list-item"><a href="https://fa25.cs161.org/proj3/flag4/" class="nav-list-link">Flag 4: nicholas</a></li><li class="nav-list-item"><a href="https://fa25.cs161.org/proj3/flag5/" class="nav-list-link">Flag 5: cs161</a></li><li class="nav-list-item"><a href="https://fa25.cs161.org/proj3/flag6/" class="nav-list-link">Flag 6: delete</a></li><li class="nav-list-item"><a href="https://fa25.cs161.org/proj3/flag7/" class="nav-list-link">Flag 7: admin</a></li><li class="nav-list-item"><a href="https://fa25.cs161.org/proj3/flag8/" class="nav-list-link">Flag 8: config</a></li><li class="nav-list-item"><a href="https://fa25.cs161.org/proj3/deliverables/" class="nav-list-link">Deliverables</a></li></ul></li></ul>
  
</nav>




  
  
    <div class="site-footer">
	Report an <a href="https://dap.berkeley.edu/get-help/report-web-accessibility-issue">accessibility issue</a>.

	<br><br>

	This site uses <a href="https://github.com/just-the-docs/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll.
</div>
  
</div>

  
  <div class="main" id="top">
    <div id="main-header" class="main-header">
  
    

<div class="search" role="search">
  <div class="search-input-wrap">
    <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search CS 161 Fall 2025" aria-label="Search CS 161 Fall 2025" autocomplete="off">
    <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label>
  </div>
  <div id="search-results" class="search-results"></div>
</div>

  
  
  
    <nav aria-label="Auxiliary" class="aux-nav">
  <ul class="aux-nav-list">
    
      <li class="aux-nav-list-item">
        <a href="index.html#" class="site-button"
          
        >
          Dark Mode
        </a>
      </li>
    
      <li class="aux-nav-list-item">
        <a href="https://textbook.cs161.org" class="site-button"
          
        >
          Textbook
        </a>
      </li>
    
      <li class="aux-nav-list-item">
        <a href="https://edstem.org/us/courses/83260" class="site-button"
          
        >
          Ed
        </a>
      </li>
    
      <li class="aux-nav-list-item">
        <a href="https://oh.cs161.org" class="site-button"
          
        >
          OH Queue
        </a>
      </li>
    
      <li class="aux-nav-list-item">
        <a href="https://forms.gle/uaFdyWWqnPkW9Uhg6" class="site-button"
          
        >
          Extensions
        </a>
      </li>
    
      <li class="aux-nav-list-item">
        <a href="https://forms.gle/bW9nen9oHGNUzWo69" class="site-button"
          
        >
          Anonymous Feedback
        </a>
      </li>
    
      <li class="aux-nav-list-item">
        <a href="https://calendar.app.google/9quTrjViGAGPG47Z8" class="site-button"
          
        >
          Student Support
        </a>
      </li>
    
  </ul>
</nav>

  
</div>

    <div class="main-content-wrap">
      <nav aria-label="Breadcrumb" class="breadcrumb-nav">
  <ol class="breadcrumb-nav-list">
    <li class="breadcrumb-nav-list-item"><a href="../index.html">Project 2</a></li>
    <li class="breadcrumb-nav-list-item"><span>Sharing and Revocation</span></li>
  </ol>
</nav>


      <div id="main-content" class="main-content">
        <main>
          
            <div class="content-container">
    <nav class="content-nav nav-list js-toc" aria-label="In-page navigation">
      <ul class="nav-list"><li class="nav-list-item"><a href="index.html#design-requirements-sharing-and-revoking" class="nav-list-link">Design Requirements: Sharing and Revoking</a></li><li class="nav-list-item"><a href="index.html#usercreateinvitation" class="nav-list-link">User.CreateInvitation</a></li><li class="nav-list-item"><a href="index.html#useracceptinvitation" class="nav-list-link">User.AcceptInvitation</a></li><li class="nav-list-item"><a href="index.html#userrevokeaccess" class="nav-list-link">User.RevokeAccess</a></li><li class="nav-list-item"><a href="index.html#design-requirements-revoked-user-adversary" class="nav-list-link">Design Requirements: Revoked User Adversary</a></li></ul>
    </nav>
  <div class="content">
<h1 id="sharing-and-revocation">
  
  
    <a href="index.html#sharing-and-revocation" class="anchor-heading" aria-labelledby="sharing-and-revocation"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Sharing and Revocation
  
  
</h1>
    

<p>In this section, you’ll design three instance methods to support sharing files with other users and revoking file access from other users.</p>

<blockquote class="EXAMPLE">
  <p>This example scenario illustrates how file sharing occurs.</p>

  <ul>
    <li>EvanBot calls <code class="language-plaintext highlighter-rouge">StoreFile("foods.txt", "eggs")</code>.
      <ul>
        <li>Assuming that foods.txt did not previously exist in EvanBot’s file namespace, this creates a new file named foods.txt in EvanBot’s namespace.</li>
        <li>Because EvanBot created the new file with a call to <code class="language-plaintext highlighter-rouge">StoreFile</code>, EvanBot is the <em>owner</em> of this file.</li>
      </ul>
    </li>
    <li>EvanBot calls <code class="language-plaintext highlighter-rouge">CreateInvitation("foods.txt", "codabot")</code>.
      <ul>
        <li>This function returns a UUID, which we’ll call an <em>invitation Datastore pointer</em>.</li>
        <li>The invitation UUID can be any UUID you like. For example, you could collect/compute any values that you want to send to the recipient user for them to access the file. Then, you could securely store these values on Datastore at some UUID, and return that UUID.</li>
      </ul>
    </li>
    <li>EvanBot uses a secure communication channel (outside of your system) to deliver the invitation UUID to CodaBot. Using this secure channel, CodaBot receives the identity of the sender (EvanBot) and the invitation UUID generated by EvanBot.</li>
    <li>CodaBot calls <code class="language-plaintext highlighter-rouge">AcceptInvitation("evanbot", invitationPtr, "snacks.txt")</code>.
      <ul>
        <li>CodaBot passes in the identity of the sender and the invitation UUID generated by EvanBot.</li>
        <li>CodaBot also passes in a filename (snacks.txt here). Note that CodaBot (the recipient user) can choose to give the file a different name while accepting the invitation.</li>
      </ul>
    </li>
    <li>CodaBot calls <code class="language-plaintext highlighter-rouge">LoadFile("snacks.txt")</code> and sees “eggs”.
      <ul>
        <li>Note that CodaBot refers to the file using the name they specified when they accepted the invitation.</li>
      </ul>
    </li>
    <li>EvanBot calls <code class="language-plaintext highlighter-rouge">LoadFile("foods.txt")</code> and sees “eggs”.
      <ul>
        <li>Note that different users can refer to the same file using different filenames.</li>
      </ul>
    </li>
    <li>EvanBot calls <code class="language-plaintext highlighter-rouge">AppendToFile("foods.txt", "and bacon")</code>.</li>
    <li>CodaBot calls <code class="language-plaintext highlighter-rouge">LoadFile("snacks.txt")</code> and sees “eggs and bacon”.
      <ul>
        <li>Note that all users should be able to see modifications to the file.</li>
      </ul>
    </li>
  </ul>
</blockquote>
<h2 id="design-requirements-sharing-and-revoking">
  
  
    <a href="index.html#design-requirements-sharing-and-revoking" class="anchor-heading" aria-labelledby="design-requirements-sharing-and-revoking"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Design Requirements: Sharing and Revoking
  
  
</h2>
    

<p>File access</p>
<ul>
  <li>The owner of a file is the user who initially created the file (i.e. with the first call to <code class="language-plaintext highlighter-rouge">StoreFile</code>).</li>
  <li>The owner must always be able to access the file. All users who have accepted an invitation to access the file (and who have not been revoked) must also be able to access the file. These users must be able to:
    <ul>
      <li>Read the file contents with <code class="language-plaintext highlighter-rouge">LoadFile</code>.</li>
      <li>Overwrite the file contents with <code class="language-plaintext highlighter-rouge">StoreFile</code>.</li>
      <li>Append to the file with <code class="language-plaintext highlighter-rouge">AppendToFile</code>.</li>
      <li>Share the file with <code class="language-plaintext highlighter-rouge">CreateInvitation</code>.</li>
    </ul>
  </li>
  <li>If a user changes the file contents, all users with access must immediately see the changes. The next time they try to access the file, all users with access should see the latest version.</li>
  <li>All users should be reading and modifying the same copy of the file. You may not create copies of the file.</li>
</ul>
<h2 id="usercreateinvitation">
  
  
    <a href="index.html#usercreateinvitation" class="anchor-heading" aria-labelledby="usercreateinvitation"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> User.CreateInvitation
  
  
</h2>
    

<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">User</span><span class="o">.</span><span class="n">CreateInvitation</span><span class="p">(</span><span class="n">filename</span> <span class="kt">string</span><span class="p">,</span> <span class="n">recipientUsername</span> <span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="n">invitationPtr</span> <span class="n">UUID</span><span class="p">,</span> <span class="n">err</span> <span class="kt">error</span><span class="p">)</span>
</code></pre></div></div>

<p>Generates an invitation UUID <code class="language-plaintext highlighter-rouge">invitationPtr</code>, which can be used by the target user <code class="language-plaintext highlighter-rouge">recipientUsername</code> to gain access to the file <code class="language-plaintext highlighter-rouge">filename</code>.</p>

<p>The invitation UUID <code class="language-plaintext highlighter-rouge">invitationPtr</code> can be any UUID value you like. For example, you could collect/compute any values that you want to send to the recipient user for them to access the file. Then, you could securely store these values on Datastore at some UUID, and return that UUID.</p>

<p>The recipient user will not be able to access the file (e.g. load, store) until they call <code class="language-plaintext highlighter-rouge">AcceptInvitation</code>, where they will choose their own (possibly different) filename for the file.</p>

<p>If the target user already has access to the file, or if the target user has already had their access to the file revoked, then this function has undefined behavior and will not be tested.</p>

<p><strong>Returns an error if:</strong></p>

<ol>
  <li>The given <code class="language-plaintext highlighter-rouge">filename</code> does not exist in the personal file namespace of the caller.</li>
  <li>The given <code class="language-plaintext highlighter-rouge">recipientUsername</code> does not exist.</li>
  <li>Sharing cannot be completed due to any malicious action.</li>
</ol>
<h2 id="useracceptinvitation">
  
  
    <a href="index.html#useracceptinvitation" class="anchor-heading" aria-labelledby="useracceptinvitation"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> User.AcceptInvitation
  
  
</h2>
    

<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">User</span><span class="o">.</span><span class="n">AcceptInvitation</span><span class="p">(</span><span class="n">senderUsername</span> <span class="kt">string</span><span class="p">,</span> <span class="n">invitationPtr</span> <span class="n">UUID</span><span class="p">,</span> <span class="n">filename</span> <span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="n">err</span> <span class="kt">error</span><span class="p">)</span>
</code></pre></div></div>

<p>Accepts an invitation by inputting the username of the sender (<code class="language-plaintext highlighter-rouge">senderUsername</code>), and the invitation UUID (<code class="language-plaintext highlighter-rouge">invitationPtr</code>) that the sender previously generated with a call to <code class="language-plaintext highlighter-rouge">CreateInvitation</code>.</p>

<p>You can assume that after the sender generates an <code class="language-plaintext highlighter-rouge">invitationPtr</code> UUID, the sender uses a secure communication channel (outside of your system) to deliver that UUID to the recipient. Using this secure channel, the recipient receives the UUID and the sender’s username, and can input them into <code class="language-plaintext highlighter-rouge">AcceptInvitation</code>.</p>

<p>Allows the recipient user to choose their own <code class="language-plaintext highlighter-rouge">filename</code> for the shared file in their own file namespace. The recipient could choose to give the file a different name than what the sender named the file.</p>

<p>After calling this function, the recipient user should be able to perform all operations (load, store, append, create invitation) on the shared file, using their own chosen <code class="language-plaintext highlighter-rouge">filename</code>.</p>

<p>This function has undefined behavior and will not be tested if the user passes in an invitation UUID that has already been accepted.</p>

<p><strong>Returns an error if:</strong></p>

<ol>
  <li>The user already has a file with the chosen <code class="language-plaintext highlighter-rouge">filename</code> in their personal file namespace.</li>
  <li>Something about the <code class="language-plaintext highlighter-rouge">invitationPtr</code> is wrong (e.g. the value at that UUID on Datastore is corrupt or missing, or the user cannot verify that <code class="language-plaintext highlighter-rouge">invitationPtr</code> was provided by <code class="language-plaintext highlighter-rouge">senderUsername</code>).</li>
  <li>The invitation is no longer valid due to revocation.</li>
</ol>

<blockquote class="QUESTION">
  <p><strong>File Sharing</strong>: What gets created on <code class="language-plaintext highlighter-rouge">CreateInvitation</code>, and what changes on <code class="language-plaintext highlighter-rouge">AcceptInvitation</code>?</p>

  <p>EvanBot (the file owner) wants to share the file with CodaBot. What is stored in Datastore when creating the invitation, and what is the UUID returned? What values on Datastore are changed when CodaBot accepts the invitation? How does CodaBot access the file in the future?</p>

  <p>CodaBot (not the file owner) wants to share the file with PintoBot. What is the sharing process like when a non-owner shares? (Same questions as above; your answers might be the same or different depending on your design.)</p>
</blockquote>
<h2 id="userrevokeaccess">
  
  
    <a href="index.html#userrevokeaccess" class="anchor-heading" aria-labelledby="userrevokeaccess"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> User.RevokeAccess
  
  
</h2>
    

<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">User</span><span class="o">.</span><span class="n">RevokeAccess</span><span class="p">(</span><span class="n">filename</span> <span class="kt">string</span><span class="p">,</span> <span class="n">recipientUsername</span> <span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="n">err</span> <span class="kt">error</span><span class="p">)</span>
</code></pre></div></div>

<p>Revokes access to <code class="language-plaintext highlighter-rouge">filename</code> from the target user <code class="language-plaintext highlighter-rouge">recipientUsername</code>, and all the users that <code class="language-plaintext highlighter-rouge">recipientUsername</code> shared the file with (either directly or indirectly).</p>

<p>The owner of the file must be able to call this function. This function has undefined behavior and will not be tested if the user calling it is not the owner of the file.</p>

<p>The owner can only call this function on a user the owner directly shared the file with. This function has undefined behavior and will not be tested if the target user is not someone the owner directly shared the file with.</p>

<p>Note: This function could be called either before or after the target user calls <code class="language-plaintext highlighter-rouge">AcceptInvitation</code>. Your code should be able to revoke access either way.</p>

<p>After revocation, the revoked users should not be able to access the file. They should get an error if they try to access the file using your system (e.g. by calling <code class="language-plaintext highlighter-rouge">LoadFile</code>, <code class="language-plaintext highlighter-rouge">AppendToFile</code>, etc.). Note that calling <code class="language-plaintext highlighter-rouge">StoreFile</code> on a revoked file is undefined behavior and will not be tested.</p>

<p>The revoked users should also be unable to regain access to the file, even if they try to maliciously bypass your system and directly access Datastore.</p>

<p>Non-revoked users should be able to continue accessing the file (e.g. by calling <code class="language-plaintext highlighter-rouge">LoadFile</code>, <code class="language-plaintext highlighter-rouge">StoreFile</code>, etc.), without needing to re-accept any invitations.</p>

<p><strong>Returns an error if:</strong></p>

<ol>
  <li>The given <code class="language-plaintext highlighter-rouge">filename</code> does not exist in the caller’s personal file namespace.</li>
  <li>The given <code class="language-plaintext highlighter-rouge">filename</code> is not currently shared with <code class="language-plaintext highlighter-rouge">recipientUsername</code>.</li>
  <li>Revocation cannot be completed due to malicious action.</li>
</ol>

<blockquote class="EXAMPLE">
  <p>This example scenario illustrates revocation behavior.</p>

  <p>Consider the following sharing tree structure. (An edge from A to B indicates that A shared the user with B.)</p>

  <p><img src="https://assets.cs161.org/proj2/proj2-spec-share-diagram.png" alt="A tree with nodes ABCDEFG." /></p>

  <ul>
    <li>A calls <code class="language-plaintext highlighter-rouge">RevokeAccess(file, B)</code>.
      <ul>
        <li>This call is defined because A is the owner. Any other user calling revoke is undefined behavior and will not be tested.</li>
        <li>This call is defined because A directly shared the file with B. A can only call revoke on B and C; revoking on any other user is undefined behavior and will not be tested.</li>
      </ul>
    </li>
    <li>Users B, D, E, and F should all lose access to the file.
      <ul>
        <li>If any of these users try to access the file (load, append, create invitation), the function should error.</li>
        <li>These users can now be malicious: they can use values they’ve previously written down, and access Datastore (without listing out all UUIDs). However, they should still be unable to read the file, modify the file, or deduce when future updates are happening.</li>
      </ul>
    </li>
    <li>Users C and G can continue accessing the file, without re-accepting any invitation.
      <ul>
        <li>For example, <code class="language-plaintext highlighter-rouge">C.LoadFile(file)</code> should work without re-accepting an invitation.</li>
      </ul>
    </li>
  </ul>
</blockquote>
<h2 id="design-requirements-revoked-user-adversary">
  
  
    <a href="index.html#design-requirements-revoked-user-adversary" class="anchor-heading" aria-labelledby="design-requirements-revoked-user-adversary"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Design Requirements: Revoked User Adversary
  
  
</h2>
    

<p>Once a user has their access revoked, they become a malicious user, who we’ll call the Revoked User Adversary. The Revoked User Adversary will not collude with any other users, and they will not collude with the Datastore Adversary.</p>

<p>The Revoked User Adversary’s goal is to re-obtain access to the file. The revoked user will not perform malicious actions on other files that they still have access to. Their only goal is to re-obtain access to the file that they lost access to.</p>

<p>The Revoked User Adversary might attempt to re-obtain access by calling functions with different arguments (e.g. calling <code class="language-plaintext highlighter-rouge">AcceptInvitation</code> again).</p>

<p>The Revoked User Adversary may also try to re-obtain access by calling <code class="language-plaintext highlighter-rouge">DatastoreGet</code> and <code class="language-plaintext highlighter-rouge">DatastoreSet</code> and maliciously affecting Datastore. However, unlike the Datastore Adversary, they do not have a global view of Datastore (i.e. they cannot list all UUIDs that have been in use).</p>

<p>The Revoked User Adversary will not perform any rollback attacks: Given a specific UUID (that they previously had access to), they will not read the value at that UUID, and then later replace the value at that UUID with the older value they read. They will also not perform any rollback attacks on multiple UUIDs.</p>

<p>Prior to having their access revoked, the Revoked User Adversary could have written down any values that they have previously seen. The Revoked User Adversary has a copy of your code running on their local computer, so they could inspect the code and learn the values of any variables that you computed.</p>

<p>Your code should ensure that the Revoked User Adversary is unable to learn anything about any future writes or appends to the file (learning about the file before they got revoked is okay). For example, they cannot know what the latest contents of the file are, and they should be unable to make modifications to the file without being detected. Also, they cannot know when future updates are happening (e.g. they should not be able to deduce how many times the file has been updated in the past day).</p>

<blockquote class="QUESTION">
  <p><strong>File Revocation</strong>: What values need to be updated when revoking?</p>

  <p>Using the diagram above as reference, suppose A revokes B’s access. What values in Datastore are updated? How do you ensure C and G still have access to the file? How do you ensure that B, D, E, and F lose access to the file?</p>

  <p>How do you ensure that a Revoked User Adversary cannot read or modify the file without being detected, even if they can directly access Datastore and remember values computed earlier? How do you ensure that a Revoked User Adversary cannot learn about when future updates are happening?</p>
</blockquote>

  </div>
</div>

          

          
            
          
        </main>
        

  <hr>
  <footer>
    

    









<script>
  (function () {
    var navList = document.querySelector('.aux-nav-list');
    if (!navList || !navList.firstElementChild) return;
    var darkToggle = navList.firstElementChild;
    darkToggle.addEventListener('click', (e) => {
      e.preventDefault();
      toggleDark();
    });
  })();
</script>

<script src="../../assets/js/tocbot.min.js"></script>
<script>
  // Tries to mirror the HTML TOC
  tocbot.init({
    tocSelector: '.js-toc',
    contentSelector: '.content',
    headingSelector: 'h2,h3,h4,h5,h6',
    ignoreSelector: '.no_toc',
    hasInnerContainers: true,
    linkClass: 'nav-list-link',
    activeLinkClass: 'active',
    listClass: 'nav-list',
    listItemClass: 'nav-list-item',
    activeListItemClass: 'active',
    collapseDepth: 3,
    scrollSmooth: false,
  });
</script>


    
  </footer>


      </div>
    </div>
    
      

<div class="search-overlay"></div>

    
  </div>

  
</body>
</html>

